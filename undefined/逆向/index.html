<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>第一篇文章 | yunchen</title><meta name="author" content="yunchen"><meta name="copyright" content="yunchen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="逆向1.工具ida 1234567891011121314151617ida操作1.f5查看伪代码2.Alt+T 搜索3.空格可在流程图和代码中切换4.Ctrl+F在函数框搜索函数5.shift+F12查看string信息6.r将编码转换成字符7.shift+F2唤出IDA的“执行脚本”窗口，根据题目给出的特征编写脚本解决问题。修改的代码范围可以上下拉动滑动窗口确认。8.在变量上按Y键可以修改变量">
<meta property="og:type" content="article">
<meta property="og:title" content="第一篇文章">
<meta property="og:url" content="https://1yunchen1.github.io/undefined/%E9%80%86%E5%90%91/index.html">
<meta property="og:site_name" content="yunchen">
<meta property="og:description" content="逆向1.工具ida 1234567891011121314151617ida操作1.f5查看伪代码2.Alt+T 搜索3.空格可在流程图和代码中切换4.Ctrl+F在函数框搜索函数5.shift+F12查看string信息6.r将编码转换成字符7.shift+F2唤出IDA的“执行脚本”窗口，根据题目给出的特征编写脚本解决问题。修改的代码范围可以上下拉动滑动窗口确认。8.在变量上按Y键可以修改变量">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yunchen-1350504234.cos.ap-guangzhou.myqcloud.com/%CE%A2%EF%BF%BD%EF%BF%BD%CD%BC%C6%AC_20250412213958.jpg">
<meta property="article:published_time" content="2025-04-15T07:39:45.608Z">
<meta property="article:modified_time" content="2025-04-15T07:50:11.156Z">
<meta property="article:author" content="yunchen">
<meta property="article:tag" content="杂七杂八">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yunchen-1350504234.cos.ap-guangzhou.myqcloud.com/%CE%A2%EF%BF%BD%EF%BF%BD%CD%BC%C6%AC_20250412213958.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "第一篇文章",
  "url": "https://1yunchen1.github.io/undefined/%E9%80%86%E5%90%91/",
  "image": "https://yunchen-1350504234.cos.ap-guangzhou.myqcloud.com/΢��ͼƬ_20250412213958.jpg",
  "datePublished": "2025-04-15T07:39:45.608Z",
  "dateModified": "2025-04-15T07:50:11.156Z",
  "author": [
    {
      "@type": "Person",
      "name": "yunchen",
      "url": "https://1yunchen1.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://1yunchen1.github.io/undefined/%E9%80%86%E5%90%91/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '第一篇文章',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://yunchen-1350504234.cos.ap-guangzhou.myqcloud.com/΢��ͼƬ_20250412213958.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">yunchen</span></a><a class="nav-page-title" href="/"><span class="site-name">第一篇文章</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">第一篇文章</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-15T07:39:45.608Z" title="发表于 2025-04-15 15:39:45">2025-04-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-15T07:50:11.156Z" title="更新于 2025-04-15 15:50:11">2025-04-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/reverse/">reverse</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="逆向"><a href="#逆向" class="headerlink" title="逆向"></a>逆向</h1><h2 id="1-工具"><a href="#1-工具" class="headerlink" title="1.工具"></a>1.工具</h2><p>ida</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ida操作</span><br><span class="line">1.f5查看伪代码</span><br><span class="line">2.Alt+T 搜索</span><br><span class="line">3.空格可在流程图和代码中切换</span><br><span class="line">4.Ctrl+F在函数框搜索函数</span><br><span class="line">5.shift+F12查看string信息</span><br><span class="line">6.r将编码转换成字符</span><br><span class="line">7.shift+F2唤出IDA的“执行脚本”窗口，根据题目给出的特征编写脚本解决问题。修改的代码范围可以上下拉动滑动窗口确认。</span><br><span class="line">8.在变量上按Y键可以修改变量类型！！！注意大小端法</span><br><span class="line">9.windows下的文件是PE文件，Linux/Unix下的文件是ELF文件</span><br><span class="line">10.ctrl+s：选择某个数据段，直接进行跳转</span><br><span class="line">11.x：对着某个函数、变量按该快捷键，可以查看它的交叉引用</span><br><span class="line">12.code（将数据转变为汇编代码，分为自动和强制执行）</span><br><span class="line">13.tab在伪代码和流程图转换</span><br><span class="line">14.Shift+e提取数据</span><br><span class="line">15.N:修改函数名</span><br><span class="line">16.按ALT+K，修改栈变量大小</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">交叉引用：变量在哪里被应用/函数在哪里被调用</span><br><span class="line"></span><br><span class="line">1.代码交叉使用</span><br><span class="line">	CODE XREF表示一个代码交叉使用，后缀表示类型</span><br><span class="line">	o 普通流 ，表示一条指令到另一条指令的顺序流</span><br><span class="line">	p 调用流，表示控制权被转交给目标函数，如BL等命令</span><br><span class="line">	j 跳转流，表示分支操作，常见于if等操作</span><br><span class="line">2.数据交叉使用</span><br><span class="line">	DATA XREF表示一个数据交叉使用</span><br><span class="line">	r 读取交叉引用，表示访问的是某个内存位置的内容</span><br><span class="line">	w 写入交叉引用，指出了修改变量内容的程序位置</span><br><span class="line">	o 偏移量交叉引用，表示引用的是某个位置的地址（而非内容）</span><br><span class="line">使用快捷键X可以快速查看交叉使用列表</span><br></pre></td></tr></table></figure>

<p>010Editor</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可以将文件以16进制打开</span><br></pre></td></tr></table></figure>

<p>asm32</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当不想让一个可疑程序运行，又想得到pe头h</span><br></pre></td></tr></table></figure>

<p>dbg</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">F7单步步入</span><br><span class="line">F8单步步过</span><br><span class="line">双击或F2增加断点</span><br><span class="line">F9运行程序</span><br><span class="line">F4运行至光标处</span><br><span class="line">双击字符串可以跳转到相应位置</span><br><span class="line">一开始进入的并非主模块，需要F9运行一下，运行至最上端无dll标志</span><br><span class="line">Ctrl+F9 跳出</span><br><span class="line">CPU反汇编代码区域右键---搜索---所有用户模块---字符串类型</span><br><span class="line">右键，search for——String references 可以搜索字符串</span><br><span class="line">Ctrl + G：跳转到指定地址</span><br><span class="line">F2/F4/F6：在寄存器窗口中修改寄存器的值</span><br><span class="line"></span><br><span class="line">代码行按空格可修改代码</span><br><span class="line">Ctrl+p为增加补丁---patch file 保存文件</span><br></pre></td></tr></table></figure>

<p>uncompyle6&#x2F;&#x2F;直接调用cmd</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">py 二进制文件反编译</span><br><span class="line">uncompyle6 -o 储存文件.py 二进制文件.pyc</span><br><span class="line">file&gt;uncompyle6 file.pyc &gt; file.py</span><br></pre></td></tr></table></figure>

<p>upx工具使用：&#x2F;&#x2F;专用文件夹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">upx.exe    //启动upx</span><br><span class="line">upx -b file_name //脱壳</span><br></pre></td></tr></table></figure>

<p>python反编译&#x2F;&#x2F;专用文件夹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python pyinstxtractor.py 文件名</span><br><span class="line">寻找解压后的.pyc文件</span><br></pre></td></tr></table></figure>



<h2 id="2-思路"><a href="#2-思路" class="headerlink" title="2.思路"></a>2.思路</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">查找主函数的方法</span><br><span class="line">1.动态调试+静态关键字</span><br><span class="line"></span><br><span class="line">根据ida的关键字在dbg中修改调试</span><br><span class="line"></span><br><span class="line">在伪代码转换c语言时，注意汇编中基址+偏移的寻址方式是下面这个</span><br><span class="line">字符作为数组下标索引原理：</span><br><span class="line">element_addr = base_addr + sizeof(T) * (int)index_char</span><br><span class="line">目标地址 = 数组首元素地址 + 数组类型 * 字符asc码</span><br><span class="line">int类型数组*4 char数组不*4 </span><br><span class="line"></span><br><span class="line">看到赋值字符串想一想大小端</span><br><span class="line">一般在CPU，x86都是小端序，但是IDA将之转换为了大端序。</span><br><span class="line">数据在内存中是小端顺序，高位在高地址处，低位在低地址处，</span><br><span class="line">memset 一般为初始化窗口函数</span><br><span class="line"></span><br><span class="line">注意事项</span><br><span class="line">不同版本ida所反汇编出的字符串是不一样的，那么判断多个字符串是不是一个就通过地址核验</span><br><span class="line">看见创建多个进程要考虑多个进程是否交替运行还是y</span><br><span class="line">实在想不出的变量/字符串，进行动态调试，有的变量是在运行过程中才被创建出来</span><br><span class="line">C语言中，对于移位操作执行的是逻辑左移和算术右移，不过对于无符号类型，所有的移位操作都是逻辑的。逻辑右移：右移后左边添加0</span><br><span class="line">算术右移：右移后添加的位与原数的符号位相同</span><br><span class="line">找到密匙时交叉引用看看是否密匙被改变</span><br></pre></td></tr></table></figure>

<ol start="3">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">die 查壳</span><br><span class="line">文件脱壳</span><br><span class="line">vscode Editor: Quick Suggestions的other中修改代码提示</span><br></pre></td></tr></table></figure>

<ol start="4">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">base64 编码过程中补2个0加一个= 4个0加2个==</span><br><span class="line">c语言数组可以用char类型索引</span><br></pre></td></tr></table></figure>

<ol start="5">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_BYTE可视作unsigned char</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">windows下的文件是PE文件，Linux/Unix下的文件是ELF文件</span><br><span class="line"></span><br><span class="line">.text代码段</span><br><span class="line">.data数据段</span><br><span class="line">bss未初始化</span><br></pre></td></tr></table></figure>

<ol start="6">
<li></li>
</ol>
<p>花指令</p>
<p>花指令存在的原因是x86指令并无定长，所以如果有人插入不影响代码运行的指令，即可改变汇编指令的表现形式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">反编译器的线性反编译(理解花指令的重点)</span><br><span class="line">反编译器的工作原理是，从exe的入口AddressOfEntryPoint处开始，依序扫描字节码，并转换为汇编，比如第一个16进制字节码是0xE8，一般0xE8代表汇编里的CALL指令，且后面跟着的4个字节数据跟地址有关，那么反编译器就读取这一共5个字节，反编译为CALL 0x地址 。</span><br><span class="line"></span><br><span class="line">对应的，有些字节码只需要一个字节就可以反编译为一条指令，例如0x55对应的是push ebp，这条语句每个函数开始都会有。同样，有些字节码又需要两个、三个、四个字节来反编译为一条指令。</span><br><span class="line"></span><br><span class="line">也就是说，如果中间只要一个地方反编译出错，例如两条汇编指令中间突然多了一个字节0xE8，那反编译器就会将其跟着的4个字节处理为CALL指令地址相关数据给反编译成一条CALL 0x地址指令。但实际上0xE8后面的四个字节是单独的字节码指令。这大概就是线性反编译。</span><br><span class="line"></span><br><span class="line">线性扫描和递归下降</span><br><span class="line">线性扫描：</span><br><span class="line">线性扫描的特点：从入口开始，一次解析每一条指令，遇到分支指令不会递归进入分支。</span><br><span class="line"></span><br><span class="line">递归下降：</span><br><span class="line">当使用线性扫描时，比如遇到call或者jmp的时候，不会跳转到对应地址进行反汇编，而是反汇编call指令的下一条指令，这就会导致出现很多问题。</span><br><span class="line">递归下降分析当遇到分支指令时，会递归进入分支进行反汇编。</span><br><span class="line"></span><br><span class="line">使反汇编引擎解析错误</span><br><span class="line">X86指令集的长度是不固定的，有一些指令很短，只有1个字节，有些指令比较长，可以达到5字节，指令长度不是固定的。如果通过巧妙的构造，引导反汇编引擎解析一条错误的指令，扰乱指令的长度，就能使反汇编引擎无法按照正常的指令长度一次解析邻接未解析的指令，最终使反汇编引擎输出错误的反汇编结果。</span><br></pre></td></tr></table></figure>

<p><img src="/image-20250409205911452.png" alt="image-20250409205911452"></p>
<p>简单理解为增加逆向难度但不会影响程序正常运行的指令</p>
<p>虽然不会影响程序的正常调用，但是在反汇编器进行反汇编时，插入的数据会影响汇编器的实际判断</p>
<p>每条语句前的栈指针就是这条语句末执行的栈指针</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">构造有效花指令的关键思路就是构造使源程序逻辑不受影响的内联汇编代码，同时在内联汇编代码中嵌入jmp call+ret之类的对应机器码指令，使反汇编软件在反汇编时错误地识别这些机器码为汇编指令，从而影响反汇编出来的程序的正常流程。</span><br></pre></td></tr></table></figure>

<p>正常情况下，代码在运行时堆栈平衡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">程序段结束后，不应发生mov esp,ebp的操作，因为在pop出栈后，esp和ebp</span><br><span class="line">的值相等</span><br></pre></td></tr></table></figure>

<p>但是由于花指令，ida会认为此时函数堆栈不平衡从而导致无法使用F5</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">花指令修改</span><br><span class="line">通过静态与动态分析进行代码调试找到不平衡代码，进行nop或着增加代码使程序堆栈平衡</span><br><span class="line">思路1.观察跳转地址，如果发现跳转地址与当前地址之间有字节影响指令，直接nop，注意跳转后的指令与修改后的指令保持</span><br><span class="line"></span><br><span class="line">在编辑中修改程序，以单字节修改，修改为90(nop指令)不执行，当程序恢复为数据后按c，将数据转变为汇编代码</span><br><span class="line">在已修补字节中查看修补过后的数据</span><br><span class="line">右键，快速修补可以将指令改为自己想要的目标指令</span><br></pre></td></tr></table></figure>

<p><img src="https://yunchen-1350504234.cos.ap-guangzhou.myqcloud.com/image-20250413170636586.png" alt="image-20250413170636586"></p>
<p>ida中修改指令(在ida中修改掉汇编后，需返回函数头按p键重新编译成一个函数，比如我修改的是main函数，就需要去寻找</p>
<p>int __cdecl main(int argc, const char **argv, const char **envp)去进行修改)</p>
<p>在ida中修改时需要注意上一步的跳转指令跳转了几个字节，在后面相应的nop掉几个字节</p>
<p><img src="/image-20250409212825772.png" alt="image-20250409212825772"></p>
<p>修改前的，使用dbg跳转后的指令，花指令往往会跳转至一个不可抵达区，这是因为使用跳转指令的操作码+正常指令的操作码所导致形成新的操作码如：E858c745ec表示call EC85D78B，而正常指令为58  c74550</p>
<p>但是在程序中会有跳转指令使ip寄存器指向正常指令位置</p>
<p><img src="/image-20250409212954168.png" alt="image-20250409212954168"></p>
<p>程序运行所恢复的的正常指令</p>
<p><img src="/image-20250409213245210.png" alt="image-20250409213245210"></p>
<p>nop掉花指令后的代码（因为jnz指令跳转目标为40102F，所以可以选择擦除也可以不擦除）</p>
<p><img src="/image-20250409213607853.png" alt="image-20250409213607853"></p>
<p>也可以选择全部擦除</p>
<p><img src="/image-20250409213940047.png" alt="image-20250409213940047"></p>
<p><img src="/image-20250409213922144.png" alt="image-20250409213922144"></p>
<p>修改前后汇编代码区别</p>
<h2 id="7-python逆向"><a href="#7-python逆向" class="headerlink" title="7.python逆向"></a>7.python逆向</h2><p>.exe文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">文件处于打包状态，使用pyinstxtractor得到.pyc二进制文件</span><br><span class="line">	python pyinstxtractor.py 文件名</span><br><span class="line">	寻找解压后的.pyc文件</span><br><span class="line">再使用</span><br><span class="line">	uncompyle6 -o 储存文件.py 二进制文件.pyc</span><br><span class="line">	file&gt;uncompyle6 file.pyc &gt; file.py</span><br><span class="line">	uncompyle6 文件名.pyc &gt; 文件名.py（3.9以下版本）</span><br><span class="line">	pycdc your_file_name.pyc &gt; output_file_name.py（</span><br><span class="line">		pycdas.exe xxxx.pyc  	#转字节码</span><br><span class="line">		pycdc.exe xxxx.pyc		#转python代码）</span><br><span class="line">得到python原始文件</span><br><span class="line">如果得到Unknown magic number 8227</span><br><span class="line">说明文件头magic number没有对上</span><br><span class="line">寻找类似.pyc文件使用winhex补全文件头</span><br><span class="line">不同版本的magic头怎么找？</span><br><span class="line">将struct.pyc文件中E3前面的十六进制数复制到xxx.pyc（或者src.pyc）文件E3前面</span><br></pre></td></tr></table></figure>

<h2 id="安卓逆向"><a href="#安卓逆向" class="headerlink" title="安卓逆向"></a>安卓逆向</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">对无后缀文件使用bandizip查看</span><br><span class="line">apktool或安卓逆向助手反编译</span><br><span class="line">将apk文件拖到模拟器里运行</span><br><span class="line">使用AndroidKiller打开这个apk</span><br><span class="line">JD-GUI软件打开classes-dex2jar.jar文件或classes-dex2jar.jar 拖入jd-gui.exe，就可以查看反编译的代码了。</span><br><span class="line">jadk打开apk文件</span><br></pre></td></tr></table></figure>

<p>思路</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">拿到文件，有无后缀，无后缀使用bandzip查看（相当于压缩包）</span><br><span class="line">apk文件用jeb打开，class类文件用jd-gui打开</span><br><span class="line">打开Bytecode，选中任意文件后双击查看源码</span><br><span class="line">Main为函数入口，通过在模拟器中实际运行的结果寻找</span><br><span class="line">jeb右键反编译查看java代码</span><br><span class="line">buu holleworld</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">点击事件就是用onClick实现的</span><br></pre></td></tr></table></figure>

<p>9.reverse迷宫题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ida动态调试无法使用的情况</span><br><span class="line">	根据ida中所生成的数组所在数据段在dbg中查找(dbg调试到数组shne)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">迷宫题特点：1.会有4键位控制移动（有一些题目上下移动不是单纯的往上或者往下 而是斜向下或者斜向上）</span><br><span class="line">		  2.一串数据，第一个数据和最后一个数据不同，中间大量数据重复</span><br><span class="line">		  3.地图边界大小，寻找判断函数，出现*号判断出界，则找到行/列大小</span><br><span class="line">		  4.提取出数据，通过行列判断得到地图</span><br><span class="line">		  5.拿到地图后手动走出或使用bfs算法</span><br><span class="line">buu：不一样的flag</span><br></pre></td></tr></table></figure>

<ol start="10">
<li></li>
</ol>
<p>windows API</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">看到DialogBoxParamA函数，该函数从对话框模板资源创建模式对话框，应用程序可以使用此值初始化对话框控件(MSDN文档截取的)。既然有初始化对话框，那么必然有读取对话框的函数，我们点进DialogBoxParamA找一下</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://1yunchen1.github.io">yunchen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://1yunchen1.github.io/undefined/%E9%80%86%E5%90%91/">https://1yunchen1.github.io/undefined/%E9%80%86%E5%90%91/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://1yunchen1.github.io" target="_blank">yunchen</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/">杂七杂八</a></div><div class="post-share"><div class="social-share" data-image="https://yunchen-1350504234.cos.ap-guangzhou.myqcloud.com/΢��ͼƬ_20250412213958.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/undefined/hello-world/" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://yunchen-1350504234.cos.ap-guangzhou.myqcloud.com/΢��ͼƬ_20250412213958.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">yunchen</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%86%E5%90%91"><span class="toc-number">1.</span> <span class="toc-text">逆向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%B7%A5%E5%85%B7"><span class="toc-number">1.1.</span> <span class="toc-text">1.工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%80%9D%E8%B7%AF"><span class="toc-number">1.2.</span> <span class="toc-text">2.思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-python%E9%80%86%E5%90%91"><span class="toc-number">1.3.</span> <span class="toc-text">7.python逆向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91"><span class="toc-number">1.4.</span> <span class="toc-text">安卓逆向</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/undefined/%E9%80%86%E5%90%91/" title="第一篇文章">第一篇文章</a><time datetime="2025-04-15T07:39:45.608Z" title="发表于 2025-04-15 15:39:45">2025-04-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/undefined/hello-world/" title="Hello World">Hello World</a><time datetime="2025-04-12T10:23:09.504Z" title="发表于 2025-04-12 18:23:09">2025-04-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By yunchen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>